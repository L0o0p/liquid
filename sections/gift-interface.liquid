{% style %}
            .gift-interface {
                margin: 0;
                padding: 0;
                background-color: {{ section.settings.background_color }};
                display: flex;
                flex-direction: column;
                align-items: center;
                min-height: 1120px;
                justify-content: start;
                padding: 20px;
                padding-top:96px;
                overflow: hidden;
                position:relative;
                gap: 48px;
              }

                .gift-interface-lace{
                position:absolute;
                z-index:50;
                bottom:-2px;
                 width: 100%;
              }

              .gift-interface-lace svg{
                display:block;
                width: 100%;
                height: auto; /* 让高度根据宽度自动调整 */
              }

            .social-tabs {
                display: flex;
                background-color: rgba(255, 255, 255, 0.8);
                border-radius: 50px;
                padding: 5px;
                /* margin-bottom: 50px; */
                width: 820px;
                height:68px;
                justify-content: space-around;
              align-content: center;
              flex-wrap: wrap;
              position:relative;
            }

            .social-tab {
                display: flex;
                align-items: center;
                padding: 8px 20px;
                border-radius: 50px;
                cursor: pointer;
                width:240px;
                height:68px;
                justify-content: center;
                gap:10px;
                font-size:24px;
                z-index:2
            }

            .social-tab.active {
                /* background-color: #6EC9CA; */
            }

            .social-tab img {
                width: 24px;
                height: 24px;
                margin-right: 8px;
            }

            .social-tab span {
                font-weight: bold;
                font-size:20px
            }

            .description{
              text-align: center;
              font-size:20px;
              font-weight:300px;
              max-width:1200px;
              color: white;
              line-height: 1.5;
              margin: 0 auto;
              padding: 0 20px;
            }

            .main-container {
                display: flex;
                flex-direction: column;
                width: 100%;
                max-width: 1200px;
            }

            .entry-indicators {
                display: flex;
                justify-content: space-around;
                width: 100%;
                margin-bottom: 30px;
            }

            .entry-indicator {
                display: flex;
                flex-direction: column;
                align-items: center;
            }

      .icon-circle {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-color: rgba(255, 255, 255, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 10px;
        transition: background-color 0.3s ease;
      }


            .icon-circle.active {
                background-color: {{ section.settings.active_color }};
            }

      .icon-circle svg {
        width: 24px;
        height: 24px;
        fill: {{ section.settings.background_color }};
        transition: fill 0.3s ease;
      }

            .icon-circle.active svg {
                fill: white;
            }

            .entry-text {
                color: white;
                font-size: 14px;
                margin-bottom: 5px;
            }

            .entry-value {
                color: white;
                font-size: 28px;
                font-weight: bold;
            }

        .progress-bar {
          width: 100%;
          height: 68px;
          background-color: rgba(255, 255, 255, 0.3);
          border-radius: 3px;
          margin-bottom: 50px;
          position: relative;
        }

      .progress-indicator {
    position: absolute;
  height: 68px;
      border: 6px solid rgba(255, 255, 255, 0.8);
        background-color: #6EC9CA;
        /* bottom: 5%; */
        border-radius: 3px;
        transition: width 0.5s ease-in-out;
        border-radius: 999px;
        top: 50%;
        transform: translateY(-50%);
        box-sizing: border-box;
        padding: 20px;
        z-index:0;
      }

            .cards-container {
                display: flex;
                gap: 20px;
                width: 100%;
                flex-wrap: nowrap;
                justify-content: space-around;
                /* height:420px */
            }

      .card {
        width: 320px;
        border-radius: 20px;
        overflow: hidden;
        cursor: pointer;
        transition: transform 0.3s, box-shadow 0.3s;
        background-color: #f0f0f0;
        margin-bottom: 20px;
        display: flex;
        flex-direction: column;
        height: 420px;
      }

            .card:hover {
                transform: translateY(-5px);
            }

            .card-image {
                display: flex;
                justify-content: center;
                align-items: center;
                height: 230px;
                background-color: rgba(255, 255, 255, 0.9);
                padding: 20px;
                position: relative;
                height: 72%;
            }

            .img-lock{
              position:absolute;
              height:70%;
              width:70%;
              opacity:1;
            }

            .img-lock svg{
              object-fit:cover;
              height:100%;
              width:100%;
              display:block
            }
             .no{
        display:none
            }

            .card-lace{
              position: absolute;
              z-index: 50;
              bottom: -5px;
              width: 100%;
            }

            .card-lace svg{
              display:block;
              width: 100%;
              height:auto
            }
            .card-lace.active svg{
            color: {{ section.settings.active_color | default: '#28a598' }};
          }

          .card.active:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0,0,0,0.1);
      }

      .card.inactive {
        opacity: 0.8;
        filter: grayscale(30%);
      }

      .card-lace svg {
        color: {{ section.settings.inactive_color }};
        transition: color 0.3s ease;
      }

      .card.active .card-lace svg {
        color: {{ section.settings.active_color }};
      }

            .card-image img {
                max-width: 100%;
                max-height: 100%;
                    object-fit: contain !important;
            }
            /* 降低未激活卡片图片的饱和度 */
      .card.inactive .card-image img,
      .card.inactive .gift-placeholder {
        filter: saturate(5%) brightness(90%);
        transition: filter 0.3s ease;
      }

      /* 确保激活状态的卡片图片正常显示 */
      .card.active .card-image img,
      .card.active .gift-placeholder {
        filter: saturate(100%) brightness(100%);
        transition: filter 0.3s ease;
      }

            .card-info {
               padding: 36px;
                background-color: {{ section.settings.active_color }};
                height: 80px;height:30%;
                width:100%
            }

            .card.inactive .card-info {
                background-color: {{ section.settings.inactive_color }};
            }

            .card.active .card-info {
                background-color: {{ section.settings.active_color }};
            }

            .card.inactive .card-title,
            .card.inactive .card-subtitle {
                color: rgba(255, 255, 255, 0.7);
            }

            .card-title {
                color: white;
                font-size: 14px;
                margin-bottom: 3px;
            }

            .card-subtitle {
                color: white;
                font-size: 14px;
                opacity: 0.9;
            }

            /* Vertical connecting lines between indicators */
            .vertical-line {
                width: 2px;
                height: 80px;
                background-color: rgba(255, 255, 255, 0.5);
                margin: 0 auto;
                display: none;
            }

              @media (max-width: 1080px) {
            .gift-interface {
                display: flex;
                justify-content: center;
              }
             }

            @media (max-width: 768px) {
              .cards-container{
                flex-direction: row;
                flex-wrap: nowrap !important;
                justify-content: space-around;
              }

              .social-tabs {
                width: 580px;
              }

              .social-tab {
                width: 180px;
              }
             }

            @media (max-width: 640px) {
              .cards-container {
                flex: 1;
                flex-direction: column;
                align-items: center;
                gap: 15px;
              }

              .description {
                font-size: 16px;
                color:black !important;
              }

              .social-tabs {
                width: 420px;
              }

              .social-tab {
                width: 130px;
                font-size: 18px;
              }
            }

            /* Responsive adjustments for mobile layout (under 480px) */
            @media (max-width: 480px) {
              .gift-interface{
                height:1500px
              }

                .social-tabs {
                    margin-bottom: 20px;
                    height:52px;
                    width:320px
                }
                .social-tab {
                    font-size: 14px;
                    height:24px;
                    width:100px
                }
              .social-tab span{
                    font-size: 14px;

              }
              .progress-indicator{
                height:0px
              }
                .main-container {
                    flex-direction: row;
                }

                .indicators-container {
                    width: 90px;
                    display: flex;
                    flex-direction: column;
                    margin-right: 15px;
                    align-items: center;
                }

                .cards-container {
                    flex: 1;
                    flex-direction: column;
                    align-items: center;
                    gap: 15px;
                }

                .card {
                    width: 100%;
                    max-width: 230px;
                    margin-bottom: 15px;
                    height:300px
                }

                .card-info{
                  padding: 8px 15px;
                }

                .entry-indicators {
                    flex-direction: column;
                    height: 100%;
                    margin-bottom: 0;
                    align-items: center;
                }

                .entry-indicator {
                    margin-bottom: 0;
                    width: 100%;
                    position: relative;
                    z-index: 2;
                }

                .icon-circle {
                    margin-bottom: 5px;
                }

                .entry-text {
                    font-size: 12px;
                    margin-bottom: 2px;
                }

                .entry-value {
                    font-size: 24px;
                    margin-bottom: 10px;
                }

                .progress-bar {
                    display: none;
                }

                .vertical-line {
                    display: block;
                }

                /* Hide the horizontal progress bar */
                .horizontal-progress {
                    display: none;
                }

                .description {
                  font-size: 14px;
                  padding: 0 15px;
                }
            }
{% endstyle %}

<div class="gift-interface">
  <div class="gift-interface-lace">
    {% render 'gift-interface-lace' %}
  </div>
  <div class="social-tabs">
    <div class="progress-indicator" style="width: {{ section.settings.current_progress }}%; left: 0%;"></div>
    <div class="social-tab active">
      <span>{{ section.settings.tab1_title }}</span>
    </div>

    <div class="social-tab">
      <span>{{ section.settings.tab2_title }}</span>
    </div>

    <div class="social-tab">
      <span>{{ section.settings.tab3_title }}</span>
    </div>
  </div>

  <div class="description">{{ section.settings.description }}</div>

  <div class="main-container">
    <div class="indicators-container">
      <div class="entry-indicators">
        {% assign indicator_count = section.blocks | where: 'type', 'indicator' | size %}
        {% for indicator in section.blocks %}
          {% if indicator.type == 'indicator' %}
            {% assign is_active = indicator.settings.is_active %}

            <div class="entry-indicator">
              <div class="icon-circle {% if is_active %}active{% endif %}" data-indicator-index="{{ forloop.index }}">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path d="{{ indicator.settings.icon_path }}"/>
                </svg>
              </div>
              <div class="entry-text">{{ indicator.settings.title }}</div>
              <div class="entry-value">{{ indicator.settings.value }}</div>
            </div>

            {% if forloop.index < indicator_count %}
              <div class="vertical-line"></div>
            {% endif %}
          {% endif %}
        {% endfor %}
      </div>
    </div>

    <div class="cards-container">
      {% for card in section.blocks %}
        {% if card.type == 'gift_card' %}
          <div
            class="card {% if card.settings.is_active %}active{% else %}inactive{% endif %}"
            data-card-index="{{ forloop.index }}"
          >
            <div class="card-image">
              <div class="img-lock {% if card.settings.is_active %}no{% endif %}">{% render 'img-lock' %}</div>

              <div class="card-lace">
                <svg width="320" height="37" viewBox="0 0 320 37" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M0 16C0 16 47.9575 32.8661 79.8333 32.8661C111.709 32.8661 127.791 16.0268 159.667 16C191.67 15.9731 207.83 32.8661 239.833 32.8661C271.837 32.8661 320 16 320 16V37H0V16Z" fill="currentColor"/>
                  <path opacity="0.4" d="M0 0C0 0 47.9575 29.7165 79.8333 29.7165C111.709 29.7165 127.791 0.0472041 159.667 0C191.67 -0.0473926 207.83 29.7165 239.833 29.7165C271.837 29.7165 320 0 320 0V37H0V0Z" fill="currentColor"/>
                </svg>
              </div>
              {% if card.settings.image != blank %}
                {{
                  card.settings.image
                  | image_url: width: 600
                  | image_tag:
                    loading: 'lazy',
                    alt: card.settings.title,
                    class: 'gift-card-img',
                    widths: '275, 550, 710, 1100',
                    sizes: '(min-width: 750px) 600px, 100vw'
                }}
              {% elsif card.settings.image_url != blank %}
                <img
                  src="{{ card.settings.image_url }}"
                  alt="{{ card.settings.title }}"
                  loading="lazy"
                  class="gift-card-img"
                >
              {% else %}
                {{ 'product-1' | placeholder_svg_tag: 'gift-placeholder placeholder-svg' }}
              {% endif %}
            </div>
            <div class="card-info">
              <div class="card-title">{{ card.settings.title }}</div>
              <div class="card-subtitle">{{ card.settings.subtitle }}</div>
            </div>
          </div>
        {% endif -%}
      {%- endfor %}
    </div>
  </div>
</div>

{% javascript %}
  document.addEventListener('DOMContentLoaded', function() {
    // 社交标签切换功能
    const socialTabs = document.querySelectorAll('.social-tab');
    socialTabs.forEach(function(tab, index) {
      tab.addEventListener('click', function() {
        socialTabs.forEach(function(t) {
          t.classList.remove('active');
        });
        this.classList.add('active');

        // 可以添加额外的功能，例如根据选择的标签显示不同的内容
        console.log('Tab ' + (index + 1) + ' selected');
      });
    });

    // 当在编辑器中时，更新进度条
    if (typeof Shopify !== 'undefined' && Shopify.designMode) {
      const progressIndicator = document.querySelector('.progress-indicator');
      if (progressIndicator) {
        progressIndicator.style.width = {{ section.settings.current_progress }} + '%';
      }
    }
  });
{% endjavascript %}

{% schema %}
{
  "name": "Gift Interface",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "textarea",
      "id": "description",
      "label": "Description Text",
      "default": "Discover the perfect balance of science and comfort. Join our exclusive co-creation program for the L1 Pro ergonomic chair and help shape a product designed for your ultimate sitting experience.",
      "info": "A description to explain this gift/reward program"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#6EC9CA"
    },
    {
      "type": "color",
      "id": "active_color",
      "label": "Active Element Color",
      "default": "#28a598"
    },
    {
      "type": "color",
      "id": "inactive_color",
      "label": "Inactive Element Color",
      "default": "#B2E3E4"
    },
    {
      "type": "text",
      "id": "tab1_title",
      "label": "First Tab Title",
      "default": "Stage 1"
    },
    {
      "type": "text",
      "id": "tab2_title",
      "label": "Second Tab Title",
      "default": "Stage 2"
    },
    {
      "type": "text",
      "id": "tab3_title",
      "label": "Third Tab Title",
      "default": "Stage 3"
    },
    {
      "type": "range",
      "id": "current_progress",
      "min": 0,
      "max": 100,
      "step": 1,
      "default": 34,
      "label": "Progress Bar (%) Display",
      "info": "Controls the progress bar display only, not card activation"
    }
  ],
  "blocks": [
    {
      "type": "indicator",
      "name": "Entry Indicator",
      "limit": 3,
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Indicator Title",
          "default": "Entry Reachs"
        },
        {
          "type": "text",
          "id": "value",
          "label": "Indicator Value",
          "default": "200"
        },
        {
          "type": "text",
          "id": "icon_path",
          "label": "SVG Icon Path",
          "default": "M20 6h-2.18c.11-.31.18-.65.18-1a2.996 2.996 0 0 0-5.5-1.65l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z"
        },
        {
          "type": "checkbox",
          "id": "is_active",
          "label": "Activate Indicator",
          "default": false,
          "info": "Check to show this indicator in active state"
        }
      ]
    },
    {
      "type": "gift_card",
      "name": "Gift Card",
      "limit": 3,
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Card Title",
          "default": "Activity Gift Name"
        },
        {
          "type": "text",
          "id": "subtitle",
          "label": "Card Subtitle",
          "default": "double line"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Card Image"
        },
        {
          "type": "text",
          "id": "image_url",
          "label": "Image URL",
          "info": "Upload image in Files section and paste URL here"
        },
        {
          "type": "checkbox",
          "id": "is_active",
          "label": "Activate Card",
          "default": false,
          "info": "Check to show this card in active state"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Gift Interface",
      "settings": {
        "description": "Discover the perfect balance of science and comfort. Join our exclusive co-creation program for the L1 Pro ergonomic chair and help shape a product designed for your ultimate sitting experience.",
        "background_color": "#6EC9CA",
        "active_color": "#28a598",
        "inactive_color": "#B2E3E4",
        "tab1_title": "Stage 1",
        "tab2_title": "Stage 2",
        "tab3_title": "Stage 3",
        "current_progress": 34
      },
      "blocks": [
        {
          "type": "indicator",
          "settings": {
            "title": "Entries",
            "value": "100",
            "icon_path": "M20 6h-2.18c.11-.31.18-.65.18-1a2.996 2.996 0 0 0-5.5-1.65l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z",
            "is_active": true
          }
        },
        {
          "type": "indicator",
          "settings": {
            "title": "Following",
            "value": "50",
            "icon_path": "M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z",
            "is_active": false
          }
        },
        {
          "type": "indicator",
          "settings": {
            "title": "Likes",
            "value": "200",
            "icon_path": "M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z",
            "is_active": false
          }
        },
        {
          "type": "gift_card",
          "settings": {
            "title": "Bronze Gift",
            "subtitle": "Entry level gift",
            "image_url": "//cdn.shopify.com/s/files/1/0603/7431/9272/files/airphone-active.png?v=1745032571",
            "is_active": true
          }
        },
        {
          "type": "gift_card",
          "settings": {
            "title": "Silver Gift",
            "subtitle": "Mid-tier reward",
            "image_url": "//cdn.shopify.com/s/files/1/0603/7431/9272/files/airphone-active.png?v=1745032571",
            "is_active": false
          }
        },
        {
          "type": "gift_card",
          "settings": {
            "title": "Gold Gift",
            "subtitle": "Premium reward",
            "image_url": "//cdn.shopify.com/s/files/1/0603/7431/9272/files/airphone-active.png?v=1745032571",
            "is_active": false
          }
        }
      ]
    }
  ]
}
{% endschema %}
